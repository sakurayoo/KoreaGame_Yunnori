<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>擲柶遊戲</title>
    <style>
        .container {
            display: flex;
            width: 100%;
            height: auto;
            justify-content: space-between;
        }


        .item-center {
            position: relative;
            text-align: center;
        }

        .areatext {
            position: absolute;
            /* text-shadow: 0 0 0.2em rgba(0, 0, 0, 0.5);
            color: #000;
            background-color: rgba(255, 255, 255, 0.523);
            border-style: inset;
            border-width: 1px;
            border-color: forestgreen; */
        }
        .dice {
            position: absolute;
            height: 15%;top:85%;left:85%;

        }
        .dice2 {
            position: absolute;
            -webkit-filter:brightness(.5);
        }
        .cat{
            width:3.5vh;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="item-right"></div>
        <div class="item-center">

            <div style="height: 90vh;">
                <!-- 四邊 -->
                <p class="areatext" style="top:55%;left:90%;" id="m0"><a href="#a">1P玩家</a></p>
                <p class="areatext" style="top:70%;left:90%;" id="m00"><a href="#a">2P玩家</a></p>
                <p class="areatext" style="top:62%;left:77%;" id="m1"><a href="#a"></a></p>
                <p class="areatext" style="top:50%;left:77%;" id="m2"><a href="#a"></a></p>
                <p class="areatext" style="top:38%;left:77%;" id="m3"><a href="#a"></a></p>
                <p class="areatext" style="top:26%;left:77%;" id="m4"><a href="#a"></a></p>
                <p class="areatext" style="top:13%;left:77%;" id="m5"><a href="#a"></a></p>
                <p class="areatext" style="top:13%;left:65%;" id="m6"><a href="#a"></a></p>
                <p class="areatext" style="top:13%;left:54%;" id="m7"><a href="#a"></a></p>
                <p class="areatext" style="top:13%;left:43%;" id="m8"><a href="#a"></a></p>
                <p class="areatext" style="top:13%;left:32%;" id="m9"><a href="#a"></a></p>

                <p class="areatext" style="top:13%;left:19%;" id="m10"><a href="#a"></a></p>
                <p class="areatext" style="top:26%;left:19%;" id="m11"><a href="#a"></a></p>
                <p class="areatext" style="top:38%;left:19%;" id="m12"><a href="#a"></a></p>
                <p class="areatext" style="top:50%;left:19%;" id="m13"><a href="#a"></a></p>
                <p class="areatext" style="top:62%;left:19%;" id="m14"><a href="#a"></a></p>
                <p class="areatext" style="top:75%;left:19%;" id="m15"><a href="#a"></a></p>
                <p class="areatext" style="top:75%;left:31.5%;" id="m16"><a href="#a"></a></p>
                <p class="areatext" style="top:75%;left:42.5%;" id="m17"><a href="#a"></a></p>
                <p class="areatext" style="top:75%;left:54%;" id="m18"><a href="#a"></a></p>
                <p class="areatext" style="top:75%;left:65%;" id="m19"><a href="#a"></a></p>
                <!-- 斜角 -->
                <p class="areatext" style="top:24%;left:68%;" id="m20"><a href="#a"></a></p>
                <p class="areatext" style="top:34%;left:58%;" id="m21"><a href="#a"></a></p>
                <p class="areatext" style="top:45%;left:48%;" id="m22"><a href="#a"></a></p>
                <p class="areatext" style="top:55.5%;left:58%;" id="m28"><a href="#a"></a></p>
                <p class="areatext" style="top:65.5%;left:67.5%;" id="m29"><a href="#a"></a></p>
                <p class="areatext" style="top:24%;left:28%;" id="m25"><a href="#a"></a></p>
                <p class="areatext" style="top:34%;left:38%;" id="m26"><a href="#a"></a></p>
                <p class="areatext" style="top:55.5%;left:38%;" id="m23"><a href="#a"></a></p>
                <p class="areatext" style="top:65%;left:29%;" id="m24"><a href="#a"></a></p>

                <!-- <button style="position: absolute;top:90%;left:90%;" onclick="throwdice()">你好</button> -->
                <p class="areatext" id="p1" onclick="move('0')" style="top:90%;left:10%; display: none;">
                    <a href="#a">1</a>
                </p>
                <p class="areatext" id="p2" onclick="move('1')" style="top:90%;left:15%; display: none;">
                    <a href="#a">2</a>
                </p>
                <p class="areatext" id="p3" onclick="move('2')" style="top:90%;left:20%; display: none;">
                    <a href="#a">3</a>
                </p>
                <p class="areatext" id="p4" onclick="move('3')" style="top:90%;left:25%; display: none;">
                    <a href="#a">4</a>
                </p>
                
                <img class="dice" id="dicem" style="-webkit-filter:brightness(.5);" src="./dice1.png" alt="" srcset="">
                <img class="dice" onclick="throwdice()" id="dice" src="./dice1.png" alt="" srcset="">
                <img src="checkerboard.jpg" style="height: 100%;" alt="" srcset="">
                <br><span id="hint"></span>
            </div>
            

            


        </div>
        <div class="item-left"></div>
    </div>
</body>
<script>
    let player1_old = [0, 0, 0, 0]; //存放四個骰子的位置 玩家1 判斷哪一隻骰子移動，做動畫
    let player2_old = [0,0,0,0]; //存放四個骰子的位置 玩家2 判斷哪一隻骰子移動，做動畫
    let player1_q = [0, 0, 0, 0]; //存放四個骰子的位置 玩家1
    let player2_q = [0,0,0,0]; //存放四個骰子的位置 玩家2
    let y = 0; //player1 or 2
    var dice = 0; //存放骰到數值 1豬 2狗 3羊 4牛 5馬
    document.getElementById("m0").innerHTML = "<span onclick='move(`0`)' id=player1_q[0]><img src='./cat.gif' class='cat' alt='貓'></span>"+"<span onclick='move(`1`)' id=player1_q[1]><img src='./cat.gif' class='cat' alt='貓'></span><br>"+"<span onclick='move(`2`)' id=player1_q[2]><img src='./cat.gif' class='cat' alt='貓'></span>"+"<span onclick='move(`3`)' id=player1_q[3]><img src='./cat.gif' class='cat' alt='貓'></span>";
    document.getElementById("m00").innerHTML = "<span onclick='move(`0`)' id=player2_q[0]><img src='./cat2.gif' class='cat' alt='2P貓'></span>"+"<span onclick='move(`1`)' id=player2_q[1]><img src='./cat2.gif' class='cat' alt='2P貓'></span><br>"+"<span onclick='move(`2`)' id=player2_q[2]><img src='./cat2.gif' class='cat' alt='2P貓'></span>"+"<span onclick='move(`3`)' id=player2_q[3]><img src='./cat2.gif' class='cat' alt='2P貓'></span>";

    //m0 = 我方初始
    //m00 = 敵方初始
    var round = 0;

    function throwdice() {
        dice = Math.floor(Math.random() * 5 + 1);
        //1豬 2狗 3羊 4牛 5馬
        console.log(dice);
        document.getElementById("dice").src="./dice"+dice+".png";
        document.getElementById("dicem").src="./dice"+dice+".png";
        
        document.getElementById("dice").style.display = "none";


        document.getElementById("p1").style.display = "";
        document.getElementById("p2").style.display = "";
        document.getElementById("p3").style.display = "";
        document.getElementById("p4").style.display = "";
    }
    function delay(time) {
      return new Promise(resolve => setTimeout(resolve, time));
    }
    //移動邏輯
    function move(x) {
        if(y==0){

            document.getElementById("p1").style.display = "none";
            document.getElementById("p2").style.display = "none";
            document.getElementById("p3").style.display = "none";
            document.getElementById("p4").style.display = "none";
            document.getElementById("dice").style.display = "";
            document.getElementById("dice").style="";

            //在此做動畫?
            //用for判斷人物走了幾步?

            //玩家1
            // console.log(x);

            if (player1_q[x] > 19 && player1_q[x] < 25 && player1_q[x] != 22) { //20 21 23 24
                if (player1_q[x] + dice > 24) {
                    player1_q[x] = player1_q[x] + dice - 10;
                } else {
                    player1_q[x] = player1_q[x] + dice;
                }
            }
            else if (player1_q[x] > 14 && player1_q[x] < 20) {
                if (player1_q[x] + dice > 19) {
                    player1_q[x] = 30;
                }else{
                    player1_q[x]=player1_q[x] + dice;
                }
            } else if (player1_q[x] == 5) {
                player1_q[x] = 19 + dice;
            } else if (player1_q[x] == 10) { //10
                player1_q[x] = 24 + dice;
            } else if (player1_q[x] == 22) { //22
                player1_q[x] = 27 + dice;
            } else {
                player1_q[x] = player1_q[x] + dice;
            }
            if (player1_q[x] > 29) {
                console.log("完成一圈!");
            }
            console.log(player1_q[x]);
            for (let y = 0; y < 30; y++) {
                if (y == 27) {
                    continue;
                }
                document.getElementById("m00").innerHTML = " ";

                document.getElementById("m" + y).innerHTML = " ";
            }
            //攻擊判斷 (player1_q與player2_q的位置相同 這裡是P1殺P2 並且可再移動一次)
            y=1;
            for(i=0;i<4;i++){
                for(j=0;j<4;j++){
                    if(player1_q[i]==player2_q[j] && player1_q[i]!=0 && player1_q[i]>29){
                        player2_q[j]=0;
                        y=0;
                    }
                }
            }
            
    //動畫動畫動畫動畫動畫動畫動畫動畫動畫動畫動畫動畫動畫
            // for(let a=0;a<4;a++){
            //     if(player1_q[a]!=player1_old[a]){
            //         for(let b=dice-1;b>0;b--){
                        
                        
            //             let ax=player1_q[a]-b;
                        
            //             document.getElementById("m1"+ax).innerHTML += "<img src='./cat.gif' class='cat' alt='1P貓'>";
                        

            //             //alert(player1_q[a]-b);
            //         }

            //         player1_old[a]=player1_q[a];

            //        // console("old"+player1_old[a]);
            //     }
            // }


        }
        //玩家2玩家2玩家2玩家2玩家2玩家2玩家2玩家2玩家2玩家2玩家2玩家2玩家2玩家2玩家2
        else
        {
            document.getElementById("p1").style.display = "none";
            document.getElementById("p2").style.display = "none";
            document.getElementById("p3").style.display = "none";
            document.getElementById("p4").style.display = "none";
            document.getElementById("dice").style.display = "";
            document.getElementById("dice").style="";

            //在此做動畫?
            //用for判斷人物走了幾步?
            //玩家2


            if (player2_q[x] > 19 && player2_q[x] < 25 && player2_q[x] != 22) { //20 21 23 24
                if (player2_q[x] + dice > 24) {
                    player2_q[x] = player2_q[x] + dice - 10;
                } else {
                    player2_q[x] = player2_q[x] + dice;
                }
            }
            else if (player2_q[x] > 14 && player2_q[x] < 20) {
                if (player2_q[x] + dice > 19) {
                    player2_q[x] = 30;
                }else{
                    player2_q[x]=player2_q[x] + dice;
                }
            } else if (player2_q[x] == 5) {
                player2_q[x] = 19 + dice;
            } else if (player2_q[x] == 10) { //10
                player2_q[x] = 24 + dice;
            } else if (player2_q[x] == 22) { //22
                player2_q[x] = 27 + dice;
            } else {
                player2_q[x] = player2_q[x] + dice;
            }
            if (player2_q[x] > 29) {
                console.log("完成一圈!");
            }
            console.log(player2_q[x]);
            for (let y = 0; y < 30; y++) {
                if (y == 27) {
                    continue;
                }
                document.getElementById("m00").innerHTML = " ";
                document.getElementById("m" + y).innerHTML = " ";
            
            }

            //攻擊判斷 (player1_q與player2_q的位置相同 這裡是P2殺P1)
            y=0;



            for(i=0;i<4;i++){
                for(j=0;j<4;j++){
                    if(player2_q[i]==player1_q[j] && player2_q[i]!=0  && player2_q[i]<29){
                        player1_q[j]=0;
                        y=1;
                    }
                }
            }

       
        }
        console.log(y);
        console.log(player1_q[0]+","+player1_q[1]+","+player1_q[2]+","+player1_q[3]);
        console.log(player2_q[0]+","+player2_q[1]+","+player2_q[2]+","+player2_q[3]);

        //貓咪位置邏輯判斷
        //直接拉過去 無動畫 要怎ㄇ解決 ->先記錄還沒增加之前的位置?

        //玩家1的判斷
        for (let i = 0; i < player1_q.length; i++) {
            console.log(player1_q[i]);
            if(player1_q[i]<=29){
                if(i==2 && (player1_q[0]==player1_q[1] && player1_q[1]==player1_q[2]) ){
                    document.getElementById("m"+player1_q[i]).innerHTML +="<br>";
                }else if(i==3 && (player1_q[1]==player1_q[2] && player1_q[2]==player1_q[3] && player1_q[0]!=player1_q[1]) ){
                    document.getElementById("m"+player1_q[i]).innerHTML +="<br>";
                }
                document.getElementById("m"+player1_q[i]).innerHTML += "<span onclick='move(`"+i+"`)' id=player1_q["+i+"]><img src='./cat.gif' class='cat' alt='1P貓'></span>";
            }
        }

        //玩家2的判斷
        for (let i = 0; i < player2_q.length; i++) {
            console.log(player2_q[i]);
            if(player2_q[i]==0){
                if(i==2 && (player2_q[0]==player2_q[1] && player2_q[1]==player2_q[2]) ){
                    document.getElementById("m00").innerHTML +="<br>";
                }else if(i==3 && (player2_q[1]==player2_q[2] && player2_q[2]==player2_q[3] && player2_q[0]!=player2_q[1]) ){
                    document.getElementById("m00").innerHTML +="<br>";
                }
                document.getElementById("m00").innerHTML += "<span onclick='move(`"+i+"`)' id=player2_q["+i+"]><img src='./cat2.gif' class='cat' alt='2P貓'></span>";

            }
            else if(player2_q[i]<=29){
                if(i==2 && (player2_q[0]==player2_q[1] && player2_q[1]==player2_q[2]) ){
                    document.getElementById("m"+player2_q[i]).innerHTML +="<br>";
                }else if(i==3 && (player2_q[1]==player2_q[2] && player2_q[2]==player2_q[3] && player2_q[0]!=player2_q[1]) ){
                    document.getElementById("m"+player2_q[i]).innerHTML +="<br>";
                }
                document.getElementById("m"+player2_q[i]).innerHTML += "<span onclick='move(`"+i+"`)' id=player2_q["+i+"]><img src='./cat2.gif' class='cat' alt='2P貓'></span>";
            } 
        }

        
        if(y==0){

            console.log("玩家1的回合");

        }else{
            for(let a=0;a<4;a++){
                if(player2_q[a]!=player2_old[a]){
                    player2_old[a]=player2_q[a];
                }
            }
            console.log("玩家2的回合");
        
        
        }
    }

        //0>123 1>23 2>3

    
    //丟骰子>選擇人物(陣列幾)>移動
</script>

</html>